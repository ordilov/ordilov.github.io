<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8" class="jsx-8528beb17f5dcded"/><meta name="viewport" content="width=device-width, initial-scale=1" class="jsx-8528beb17f5dcded"/><meta name="description" class="jsx-8528beb17f5dcded"/><meta name="author" content="Santha Lakshmi Narayana" class="jsx-8528beb17f5dcded"/><meta name="keywords" content="backend" class="jsx-8528beb17f5dcded"/><meta property="og:title" content="Spring Security Architecture- Santha Lakshmi Narayana" class="jsx-8528beb17f5dcded"/><meta property="og:description" class="jsx-8528beb17f5dcded"/><meta property="og:url" content="https://santhalakshminarayana.github.io/blog/Spring Security Architecture" class="jsx-8528beb17f5dcded"/><meta property="og:image" content="https://santhalakshminarayana.github.io/images/undefined" class="jsx-8528beb17f5dcded"/><meta property="og:type" content="article" class="jsx-8528beb17f5dcded"/><meta property="og:article:publisher" content="https://santhalakshminarayana.github.io/" class="jsx-8528beb17f5dcded"/><meta property="og:site_name" content="Santha Lakshmi Narayana" class="jsx-8528beb17f5dcded"/><meta name="twitter:card" content="summary_large_image" class="jsx-8528beb17f5dcded"/><meta name="twitter:title" content="Spring Security Architecture- Santha Lakshmi Narayana" class="jsx-8528beb17f5dcded"/><meta name="twitter:description" class="jsx-8528beb17f5dcded"/><meta name="twitter:url" content="https://santhalakshminarayana.github.io/blog/Spring Security Architecture" class="jsx-8528beb17f5dcded"/><meta name="twitter:site" content="@santhalakshminarayana" class="jsx-8528beb17f5dcded"/><meta name="twitter:image" content="https://santhalakshminarayana.github.io/images/undefined" class="jsx-8528beb17f5dcded"/><meta name="twitter:creator" content="@santhalakshminarayana" class="jsx-8528beb17f5dcded"/><link rel="icon" href="/images/santha-lakshmi-narayana-logo.png?" class="jsx-8528beb17f5dcded"/><link rel="canonical" href="https://santhalakshminarayana.github.io/blog/Spring Security Architecture" class="jsx-8528beb17f5dcded"/><title class="jsx-8528beb17f5dcded">Spring Security Architecture- Santha Lakshmi Narayana</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous" class="jsx-8528beb17f5dcded"/><meta name="next-head-count" content="24"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/08486df8513a6a4a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/08486df8513a6a4a.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-2e51481b1d484a05.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-01df828e572375b9.js" defer=""></script><script src="/_next/static/chunks/pages/_app-2f6be537d971d336.js" defer=""></script><script src="/_next/static/chunks/d0447323-25083e8bf8ee8b2e.js" defer=""></script><script src="/_next/static/chunks/346-1dc5a38ee39c2ecb.js" defer=""></script><script src="/_next/static/chunks/446-c6580eb27135e218.js" defer=""></script><script src="/_next/static/chunks/41-17056a37629f0c2f.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bid%5D-bd22e60c6b3cff53.js" defer=""></script><script src="/_next/static/MFOkDCUxJxBF4bROlBGbX/_buildManifest.js" defer=""></script><script src="/_next/static/MFOkDCUxJxBF4bROlBGbX/_ssgManifest.js" defer=""></script><script src="/_next/static/MFOkDCUxJxBF4bROlBGbX/_middlewareManifest.js" defer=""></script><style id="__jsx-2633692617">.tags.jsx-2633692617{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:row;
-ms-flex-direction:row;
flex-direction:row;
flex-wrap:wrap;
-webkit-justify-content:center;
justify-content:center;
padding:1vw 5vw 1vw 5vw;
background-color:#fffecb;
border-bottom:5px solid #071013}
.tags.jsx-2633692617 a.jsx-2633692617{font-family:'Share Tech Mono', monospace;
color:#1d2b35;
margin:0 1em 0 1em;
-webkit-text-decoration:none;
text-decoration:none;
border-bottom:1px dashed #fb232e}
.tags.jsx-2633692617 a.jsx-2633692617:hover{background:#20a4f3;
color:#fffecb;
border-bottom:1px dashed #fffecb}
.tags.jsx-2633692617 a.jsx-2633692617:active{background:#fb232e}</style><style id="__jsx-3763204948">.header-container.jsx-3763204948{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex:1;
-ms-flex:1;
flex:1;
-webkit-flex-direction:row;
-ms-flex-direction:row;
flex-direction:row;
padding:10px 5vw 10px 5vw;
background:#1d2b35}
.header-left.jsx-3763204948{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex:1;
-ms-flex:1;
flex:1;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center}
.header-left.jsx-3763204948 a.jsx-3763204948{font-family:'Source Sans Pro', sans-serif;
-webkit-text-decoration:none;
text-decoration:none;
color:#ffaa33}
img.jsx-3763204948{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex:1;
-ms-flex:1;
flex:1;
width:calc(1.2rem + 1vw);
max-width:calc(1.2rem + 1vw);
height:auto;
margin:0 5px 0 5px}
img.jsx-3763204948:hover{cursor:pointer}
.header-left.jsx-3763204948 a.jsx-3763204948:hover{color:#20a4f3}
.header-left.jsx-3763204948 a.jsx-3763204948:active{color:#fb232e}
.header-right.jsx-3763204948{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex:3;
-ms-flex:3;
flex:3;
-webkit-flex-direction:row-reverse;
-ms-flex-direction:row-reverse;
flex-direction:row-reverse;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center}
.header-right.jsx-3763204948 a.jsx-3763204948{padding:0 1vw 0 1vw;
font-family:'Source Sans Pro', sans-serif;
-webkit-text-decoration:none;
text-decoration:none;
color:#ffaa33}
.header-right.jsx-3763204948 a.jsx-3763204948:hover{color:#20a4f3}
.header-right.jsx-3763204948 a.jsx-3763204948:active{color:#fb232e}
@media screen and (max-width:920px) {.header-container.jsx-3763204948{padding:10px 2vw 10px 2vw;
overflow-x:scroll}
#name.jsx-3763204948{display:none}
img.jsx-3763204948{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex}}
@media screen and (max-width:480px) {.header-container.jsx-3763204948{padding:10px 2vw 10px 2vw;
overflow-x:scroll}}
@media screen and (max-width:300px) {img.jsx-3763204948{display:none}}</style><style id="__jsx-1024841947">.footer-container.jsx-1024841947{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:column;
-ms-flex-direction:column;
flex-direction:column;
background:#1d2b35e6;
padding:1vw 1vw 1vw 1vw}
.footer-container-links.jsx-1024841947{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:row;
-ms-flex-direction:row;
flex-direction:row;
-webkit-justify-content:center;
justify-content:center}
.footer-links.jsx-1024841947{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-justify-content:center;
justify-content:center;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center}
.link-item.jsx-1024841947{margin:0 1vw 0 1vw}
.link.jsx-1024841947{-webkit-text-decoration:none;
text-decoration:none;
cursor: pointer:
				background-color: yellow}
.link.jsx-1024841947:hover{color:black}
.copy-right-container.jsx-1024841947{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:row;
-ms-flex-direction:row;
flex-direction:row;
-webkit-justify-content:center;
justify-content:center;
margin-top:10px}
.copy-right-text.jsx-1024841947{font-family:'Maven Pro', sans-serif;
font-size:calc(0.75rem + 0.1vw);
color:#fffecb}</style><style id="__jsx-8528beb17f5dcded">.blog-content.jsx-8528beb17f5dcded{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex:100%;
-ms-flex:100%;
flex:100%;
-webkit-flex-direction:column;
-ms-flex-direction:column;
flex-direction:column;
margin:1vw 25vw 1vw 25vw;
width:50vw;
max-width:50vw;
min-height:90vh}
@media screen and (max-width:980px) {.blog-content.jsx-8528beb17f5dcded{margin:1vw 15vw 1vw 15vw;
width:70vw;
max-width:70vw}}
@media screen and (max-width:760px) {.blog-content.jsx-8528beb17f5dcded{margin:1vw 5vw 1vw 5vw;
width:90vw;
max-width:90vw}}</style><style data-href="https://fonts.googleapis.com/css2?family=Maven+Pro&family=Share+Tech+Mono&family=Source+Sans+Pro&family=Ubuntu&display=swap">@font-face{font-family:'Maven Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/mavenpro/v28/7Auup_AqnyWWAxW2Wk3swUz56MS91Eww8SX25nM.woff) format('woff')}@font-face{font-family:'Share Tech Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sharetechmono/v13/J7aHnp1uDWRBEqV98dVQztYldFc7pw.woff) format('woff')}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v19/6xK3dSBYKcSV-LCoeQqfX1RYOo3aPA.woff) format('woff')}@font-face{font-family:'Ubuntu';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntu/v19/4iCs6KVjbNBYlgo6ew.woff) format('woff')}@font-face{font-family:'Maven Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/mavenpro/v28/7Auup_AqnyWWAxW2Wk3swUz56MS91Eww8SX21nijpBh8CvRBOB1s.woff) format('woff');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Maven Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/mavenpro/v28/7Auup_AqnyWWAxW2Wk3swUz56MS91Eww8SX21nmjpBh8CvRBOB1s.woff) format('woff');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Maven Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/mavenpro/v28/7Auup_AqnyWWAxW2Wk3swUz56MS91Eww8SX21nejpBh8CvRBOA.woff) format('woff');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Share Tech Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sharetechmono/v13/J7aHnp1uDWRBEqV98dVQztYldFcLowEFA87Heg.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v19/6xK3dSBYKcSV-LCoeQqfX1RYOo3qNa7lujVj9_mf.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v19/6xK3dSBYKcSV-LCoeQqfX1RYOo3qPK7lujVj9_mf.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v19/6xK3dSBYKcSV-LCoeQqfX1RYOo3qNK7lujVj9_mf.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v19/6xK3dSBYKcSV-LCoeQqfX1RYOo3qO67lujVj9_mf.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v19/6xK3dSBYKcSV-LCoeQqfX1RYOo3qN67lujVj9_mf.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v19/6xK3dSBYKcSV-LCoeQqfX1RYOo3qNq7lujVj9_mf.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Source Sans Pro';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/sourcesanspro/v19/6xK3dSBYKcSV-LCoeQqfX1RYOo3qOK7lujVj9w.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Ubuntu';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntu/v19/4iCs6KVjbNBYlgoKcg72nU6AF7xm.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Ubuntu';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntu/v19/4iCs6KVjbNBYlgoKew72nU6AF7xm.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Ubuntu';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntu/v19/4iCs6KVjbNBYlgoKcw72nU6AF7xm.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Ubuntu';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntu/v19/4iCs6KVjbNBYlgoKfA72nU6AF7xm.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Ubuntu';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntu/v19/4iCs6KVjbNBYlgoKcQ72nU6AF7xm.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Ubuntu';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntu/v19/4iCs6KVjbNBYlgoKfw72nU6AFw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next" data-reactroot=""><div style="min-height:100vh" class="jsx-8528beb17f5dcded"><div class="jsx-3763204948 header"><div class="jsx-3763204948 header-container"><div class="jsx-3763204948 header-left"><img src="/images/santha-lakshmi-narayana-logo.png" alt="Logo" class="jsx-3763204948"/><a id="name" class="jsx-3763204948" href="/"><b class="jsx-3763204948"> Ordinary</b></a></div><div class="jsx-3763204948 header-right"><a class="jsx-3763204948" href="/about">About</a><a href="#" class="jsx-3763204948">Tags</a><a class="jsx-3763204948" href="/">Home</a></div></div><div style="display:none" class="jsx-3763204948"><div class="jsx-2633692617 tags"><a class="jsx-2633692617" href="/tags/backend">#backend</a><a class="jsx-2633692617" href="/tags/book">#book</a><a class="jsx-2633692617" href="/tags/algorithm">#algorithm</a></div></div></div><article class="jsx-8528beb17f5dcded blog-content"><h2>Security</h2>
<p>애플리케이션에서 보안은 인증과 권한 두 가지 문제로 구분됩니다.</p>
<h3>Authentication</h3>
<p>인증을 위한 주요 전략은 인증 메서드 하나면 됩니다.<br/>
<!-- -->authenticate 메서드라고 한다면 예상되는 결과는 세 가지 중 하나입니다.</p>
<ul>
<li>인증을 성공했습니다 -&gt; 인증 주체 정보 + 인증 성공 정보</li>
<li>인증을 실패했습니다 -&gt; 인증 실패 예외 처리</li>
<li>인증을 결정할 수 없습니다 -&gt; 인증 정보 null</li>
</ul>
<p>인증 실패의 경우 401 응답과 예외 처리 정보를 보낼 수 있습니다.<br/>
<!-- -->인증 결정을 못한 경우 이어지는 다음 인증 처리로 넘기거나 예외처리할 수 있습니다.</p>
<h3>Authorization</h3>
<p>권한은 인증이 성공한 이후에 이뤄지며 인증 정보를 가지고 권한을 판단합니다.<br/>
<!-- -->나온 결과로 ROLE_ADMIN, ROLE_AUDIT 처럼 보통 ROLE_ 로 권한을 구분합니다.</p>
<h2>Web Security</h2>
<p>클라이언트에서 받아서 Servlet까지 가는 과정동안 Filters를 거치게 됩니다.<br/>
<!-- -->Filter가 연쇄적으로 구성된 FilterChain으로 HttpServletRequest가 처리됩니다.
Filter가 할 수 있는 일은 두 가지입니다.</p>
<ul>
<li>다음으로 처리될 Filter나 Servlet 처리를 막습니다. 바로 응답으로 넘어갑니다.</li>
<li>다음으로 처리될 Filter나 Servlet에 사용될 요청이나 응답을 수정합니다.</li>
</ul>
<h3>DelegatingFilterProxy</h3>
<p>DelegatingFilterProxy로 구현된 Filter는 스프링 ApplicationContext 상에서 서블릿 컨테이너 생명주기에 맞게 사용할 수 있습니다.<br/>
<!-- -->다시 말하면 서블릿 컨테이너는 아무 Filter나 사용 가능하지만, 스프링에 정의된 빈인 것을 신경쓰지 않습니다.
DelegatingFilterProxy를 사용하면 서블릿 컨테이너에 필터를 직접 등록하는 대신 스프링 빈이 대신합니다.
서블릿 컨테이너가 실행되기 이전에 필터들이 등록되어야 하는데 Proxy로 처리된 필터들이 등록됩니다.
따라서 Context에 등록된 빈들을 불러오기 이전에 컨테이너에 필터를 등록하는 작업을 할 수 있습니다.</p>
<h3>FilterChainProxy &amp; SecurityFilterChain</h3>
<p>Filter를 구현해서 사용할 때 하나의 필터가 아닌 여러개를 FilterChainProxy로 등록이 가능합니다.
이런 필터들을 SecurityFilterChain이라고 합니다.<br/>
<!-- -->하나의 필터를 여러개로 대체하는 이유는 상황이나 경로에 따라 여러 조건을 추가할 수 있습니다.<br/>
<!-- -->api를 처리할 때, view를 처리할 때등 경로에 따라 다른 필터를 적용시킬 수 있습니다.</p>
<h2>Security Filters</h2>
<p>Security Filter들은 순서에 따라 진행됩니다. 따라서 순차적인 처리가 필요하다면 대표적인 필터의 처리 순서를 알고 있는 것이 좋습니다.</p>
<ul>
<li>CorsFilter</li>
<li>CsrfFilter</li>
<li>LogOutFilter</li>
<li>OAuth2AuthorizationRequestRedirectFilter</li>
<li>BearerTokenAuthenticationFilter</li>
</ul>
<h2>Handling Security Exceptions</h2>
<p><code>ExceptionTranslationFilter</code>에선 <code>AccessDeniedException</code>이나 <code>AuthenticationException</code>을 응답으로 바꿀 수 있습니다.
필터에서 인증되지 않은 상태거나 <code>AuthenticationException</code> 이라면 다음 과정을 거칩니다.</p>
<ul>
<li>SecurityContextHolder를 비웁니다.</li>
<li>HttpServletRequest에 담긴 <code>RequestCache</code>를 저장합니다.</li>
<li>AuthenticationEntryPoint를 통해 <code>WWW-Authenticate</code>헤더로 보내거나 로그인 페이지로 리다이렉트합니다.</li>
<li><code>AccessDeniedException</code>인 경우 <code>AccessDeniedHandler</code>가 인증 거부를 처리합니다.</li>
</ul></article><div class="jsx-1024841947 footer-container"><div class="jsx-1024841947 footer-container-links"><div class="jsx-1024841947 footer-links"><div class="jsx-1024841947 link-item"><a href="https://github.com/santhalakshminarayana" rel="noreferrer" target=" _blank" class="jsx-1024841947 link"><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" style="color:#fffecb;font-size:calc(0.8rem + 1vw)" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></div></a></div><div class="jsx-1024841947 link-item"><a href="https://www.linkedin.com/in/santhalakshminarayana/" rel="noreferrer" target="_blank" class="jsx-1024841947 link"><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" style="color:#fffecb;font-size:calc(0.8rem + 1vw)" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></div></a></div><div class="jsx-1024841947 link-item"><a href="https://medium.com/@santhalakshminarayana/" rel="noreferrer" target="_blank" class="jsx-1024841947 link"><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" style="color:#fffecb;font-size:calc(0.8rem + 1vw)" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M13.54 12a6.8 6.8 0 01-6.77 6.82A6.8 6.8 0 010 12a6.8 6.8 0 016.77-6.82A6.8 6.8 0 0113.54 12zM20.96 12c0 3.54-1.51 6.42-3.38 6.42-1.87 0-3.39-2.88-3.39-6.42s1.52-6.42 3.39-6.42 3.38 2.88 3.38 6.42M24 12c0 3.17-.53 5.75-1.19 5.75-.66 0-1.19-2.58-1.19-5.75s.53-5.75 1.19-5.75C23.47 6.25 24 8.83 24 12z"></path></svg></div></a></div><div class="jsx-1024841947 link-item"><a href="https://www.kaggle.com/santhalnr/" rel="noreferrer" target="_blank" class="jsx-1024841947 link"><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" style="color:#fffecb;font-size:calc(0.8rem + 1vw)" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M.1025 7.3475c-.0681 0-.1022.0341-.1022.102v6.752c0 .0681.034.1022.1022.1022h.7049c.068 0 .1022-.034.1022-.1023v-1.481l.4187-.3985 1.5016 1.91c.041.0477.0884.0716.143.0716h.9091c.0476 0 .0748-.0135.0817-.0407.0135-.041.0066-.075-.0206-.1023l-1.9816-2.4618 1.9002-1.8384c.0204-.0205.0237-.051.01-.092-.0137-.0339-.0408-.051-.0816-.051h-.9398c-.0477 0-.0953.024-.143.0716L.9096 11.607V7.4496c0-.0679-.0342-.102-.1022-.102zm18.0417 0c-.068 0-.102.0341-.102.102v6.752c0 .0681.034.102.102.102h.705c.068 0 .102-.034.102-.102v-6.752c0-.068-.034-.102-.102-.102zM5.961 9.6254c-.5653 0-1.11.1806-1.6343.5415-.0545.0545-.0648.102-.0307.143l.3676.5208c.0272.0477.0717.0545.133.0204.3948-.2722.783-.4086 1.1644-.4086.2927 0 .5158.0886.669.2656.1532.1771.2197.3917.1992.6436-.6606.0681-1.1545.1495-1.4813.245-.8308.2383-1.2461.6913-1.2461 1.3586 0 .4222.1533.7695.4598 1.0419.3132.2654.6845.3982 1.1134.3982.4698 0 .8545-.1125 1.1542-.3372v.1432c0 .0682.0374.102.1123.102h.7048c.068 0 .102-.0338.102-.102V11.372c0-.6604-.2245-1.1406-.6739-1.4403-.3065-.2043-.6776-.3063-1.1134-.3063zm4.3225 0c-.6742 0-1.195.2622-1.5627.7865-.3133.4359-.4699.9671-.4699 1.5936 0 .6604.1634 1.2087.4903 1.6444.3744.4972.892.7455 1.5526.7455.5313 0 .9567-.1327 1.2768-.3982v.531c0 .858-.4122 1.287-1.236 1.287-.361 0-.732-.1907-1.1132-.572a.098.098 0 00-.0716-.0306c-.034 0-.0613.0102-.0817.0307l-.4802.48c-.0408.0613-.0375.1124.0103.1532.1361.1157.2554.2129.3576.2911.102.0783.1905.1413.2656.189.354.1975.7284.2961 1.1235.2961.6808 0 1.207-.1925 1.5781-.577.3711-.3848.5567-.9484.5567-1.6903V9.8196c0-.068-.034-.102-.102-.102h-.705c-.0682 0-.1021.034-.1021.102v.2043c-.3471-.2657-.7763-.3985-1.287-.3985zm4.8021 0c-.6742 0-1.195.2622-1.5627.7865-.3132.4359-.4699.9671-.4699 1.5936 0 .6604.1633 1.2087.4903 1.6444.3744.4972.892.7455 1.5526.7455.5311 0 .9566-.1327 1.2768-.3982v.531c0 .858-.4122 1.287-1.236 1.287-.361 0-.732-.1907-1.1133-.572a.098.098 0 00-.0716-.0306c-.034 0-.0612.0102-.0816.0307l-.48.48c-.0409.0613-.0376.1124.01.1532.1363.1157.2555.2129.3576.2911.1021.0783.1906.1413.2657.189.354.1975.7285.2961 1.1237.2961.6808 0 1.2068-.1925 1.5781-.577.371-.3848.5565-.9484.5565-1.6903V9.8196c0-.068-.034-.102-.102-.102h-.7049c-.0682 0-.1022.034-.1022.102v.2043c-.3474-.2657-.7763-.3985-1.287-.3985zm6.7457 0c-.6537 0-1.185.211-1.5936.6332-.4427.4632-.664 1.0283-.664 1.6956 0 .7083.225 1.2905.6743 1.7467.463.463 1.042.6945 1.7366.6945.6467 0 1.2154-.1838 1.7057-.5515.0545-.041.0545-.0884 0-.143l-.4802-.4903c-.041-.0409-.0919-.0409-.1533 0-.2998.2112-.6368.3167-1.0112.3167-.4222 0-.7729-.119-1.052-.3576-.2452-.2248-.3882-.5038-.429-.8375h3.3197c.0679 0 .1022-.0341.1022-.1023l.01-.2244c.0341-.6878-.1668-1.26-.6025-1.7162-.4224-.4426-.9432-.664-1.5627-.664zm-.0206.7865c.3268 0 .6062.1056.8377.3166.2452.211.371.4734.378.7865h-2.4618c.0613-.3269.2077-.5925.4392-.7968.2313-.2042.5004-.3063.8069-.3063zm-11.4249.102c.6196 0 1.0146.2181 1.1848.6538v1.6854c-.1702.4358-.5755.6538-1.2155.6538-.3133 0-.5687-.0986-.7661-.2963-.2656-.2518-.3983-.6538-.3983-1.2053 0-.9941.3984-1.4914 1.1951-1.4914zm4.802 0c.6196 0 1.0148.2181 1.1851.6538h-.0002v1.6854c-.1703.4358-.5755.6538-1.2155.6538-.3132 0-.5686-.0986-.7661-.2963-.2655-.2518-.3983-.6538-.3983-1.2053 0-.9941.3983-1.4914 1.195-1.4914zm-8.3586 1.6547v1.0215c-.286.286-.6675.412-1.1441.3779-.1703-.0135-.32-.0663-.4493-.1582-.1294-.0919-.2045-.2129-.2249-.3627-.0341-.2657.1158-.47.4495-.6129.2452-.1088.7013-.1974 1.3688-.2656z"></path></svg></div></a></div><div class="jsx-1024841947 link-item"><a href="https://www.quora.com/profile/Lakshmi-Narayana-217" rel="noreferrer" target="_blank" class="jsx-1024841947 link"><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" style="color:#fffecb;font-size:calc(0.8rem + 1vw)" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title></title><path d="M12.738 18.701c-.831-1.635-1.805-3.287-3.708-3.287-.362 0-.727.061-1.059.209l-.646-1.289c.786-.678 2.058-1.214 3.693-1.214 2.544 0 3.851 1.229 4.888 2.792.613-1.335.904-3.14.904-5.375 0-5.582-1.744-8.447-5.822-8.447-4.018 0-5.757 2.865-5.757 8.447 0 5.553 1.739 8.389 5.757 8.389.64 0 1.22-.069 1.75-.225zm.996 1.947c-.881.237-1.817.366-2.743.366-5.352 0-10.59-4.269-10.59-10.478C.402 4.271 5.639 0 10.991 0c5.441 0 10.628 4.238 10.628 10.537 0 3.504-1.635 6.351-4.01 8.191.764 1.148 1.543 1.914 2.652 1.914 1.199 0 1.68-.915 1.77-1.649h1.557c.092.974-.402 5.007-4.766 5.007-2.652 0-4.047-1.528-5.096-3.328l.008-.024z"></path></svg></div></a></div></div></div><div class="jsx-1024841947 copy-right-container"><p class="jsx-1024841947 copy-right-text">Santha Lakshmi Narayana © 2021</p></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postMetadata":{"layout":"post","title":"Spring Security Architecture","date":"2022-02-03 00:01:00 +0900","category":"backend","tags":["backend"],"keywords":["backend"],"id":"Spring Security Architecture"},"postContent":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, {})\n  })) : _createMdxContent();\n  function _createMdxContent() {\n    const _components = Object.assign({\n      h2: \"h2\",\n      p: \"p\",\n      h3: \"h3\",\n      br: \"br\",\n      ul: \"ul\",\n      li: \"li\",\n      code: \"code\"\n    }, _provideComponents(), props.components);\n    return _jsxs(_Fragment, {\n      children: [_jsx(_components.h2, {\n        children: \"Security\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"애플리케이션에서 보안은 인증과 권한 두 가지 문제로 구분됩니다.\"\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"Authentication\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"인증을 위한 주요 전략은 인증 메서드 하나면 됩니다.\", _jsx(_components.br, {}), \"\\n\", \"authenticate 메서드라고 한다면 예상되는 결과는 세 가지 중 하나입니다.\"]\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsx(_components.li, {\n          children: \"인증을 성공했습니다 -\u003e 인증 주체 정보 + 인증 성공 정보\"\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"인증을 실패했습니다 -\u003e 인증 실패 예외 처리\"\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"인증을 결정할 수 없습니다 -\u003e 인증 정보 null\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"인증 실패의 경우 401 응답과 예외 처리 정보를 보낼 수 있습니다.\", _jsx(_components.br, {}), \"\\n\", \"인증 결정을 못한 경우 이어지는 다음 인증 처리로 넘기거나 예외처리할 수 있습니다.\"]\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"Authorization\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"권한은 인증이 성공한 이후에 이뤄지며 인증 정보를 가지고 권한을 판단합니다.\", _jsx(_components.br, {}), \"\\n\", \"나온 결과로 ROLE_ADMIN, ROLE_AUDIT 처럼 보통 ROLE_ 로 권한을 구분합니다.\"]\n      }), \"\\n\", _jsx(_components.h2, {\n        children: \"Web Security\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"클라이언트에서 받아서 Servlet까지 가는 과정동안 Filters를 거치게 됩니다.\", _jsx(_components.br, {}), \"\\n\", \"Filter가 연쇄적으로 구성된 FilterChain으로 HttpServletRequest가 처리됩니다.\\nFilter가 할 수 있는 일은 두 가지입니다.\"]\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsx(_components.li, {\n          children: \"다음으로 처리될 Filter나 Servlet 처리를 막습니다. 바로 응답으로 넘어갑니다.\"\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"다음으로 처리될 Filter나 Servlet에 사용될 요청이나 응답을 수정합니다.\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"DelegatingFilterProxy\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"DelegatingFilterProxy로 구현된 Filter는 스프링 ApplicationContext 상에서 서블릿 컨테이너 생명주기에 맞게 사용할 수 있습니다.\", _jsx(_components.br, {}), \"\\n\", \"다시 말하면 서블릿 컨테이너는 아무 Filter나 사용 가능하지만, 스프링에 정의된 빈인 것을 신경쓰지 않습니다.\\nDelegatingFilterProxy를 사용하면 서블릿 컨테이너에 필터를 직접 등록하는 대신 스프링 빈이 대신합니다.\\n서블릿 컨테이너가 실행되기 이전에 필터들이 등록되어야 하는데 Proxy로 처리된 필터들이 등록됩니다.\\n따라서 Context에 등록된 빈들을 불러오기 이전에 컨테이너에 필터를 등록하는 작업을 할 수 있습니다.\"]\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"FilterChainProxy \u0026 SecurityFilterChain\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"Filter를 구현해서 사용할 때 하나의 필터가 아닌 여러개를 FilterChainProxy로 등록이 가능합니다.\\n이런 필터들을 SecurityFilterChain이라고 합니다.\", _jsx(_components.br, {}), \"\\n\", \"하나의 필터를 여러개로 대체하는 이유는 상황이나 경로에 따라 여러 조건을 추가할 수 있습니다.\", _jsx(_components.br, {}), \"\\n\", \"api를 처리할 때, view를 처리할 때등 경로에 따라 다른 필터를 적용시킬 수 있습니다.\"]\n      }), \"\\n\", _jsx(_components.h2, {\n        children: \"Security Filters\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Security Filter들은 순서에 따라 진행됩니다. 따라서 순차적인 처리가 필요하다면 대표적인 필터의 처리 순서를 알고 있는 것이 좋습니다.\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsx(_components.li, {\n          children: \"CorsFilter\"\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"CsrfFilter\"\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"LogOutFilter\"\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"OAuth2AuthorizationRequestRedirectFilter\"\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"BearerTokenAuthenticationFilter\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.h2, {\n        children: \"Handling Security Exceptions\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [_jsx(_components.code, {\n          children: \"ExceptionTranslationFilter\"\n        }), \"에선 \", _jsx(_components.code, {\n          children: \"AccessDeniedException\"\n        }), \"이나 \", _jsx(_components.code, {\n          children: \"AuthenticationException\"\n        }), \"을 응답으로 바꿀 수 있습니다.\\n필터에서 인증되지 않은 상태거나 \", _jsx(_components.code, {\n          children: \"AuthenticationException\"\n        }), \" 이라면 다음 과정을 거칩니다.\"]\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsx(_components.li, {\n          children: \"SecurityContextHolder를 비웁니다.\"\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"HttpServletRequest에 담긴 \", _jsx(_components.code, {\n            children: \"RequestCache\"\n          }), \"를 저장합니다.\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"AuthenticationEntryPoint를 통해 \", _jsx(_components.code, {\n            children: \"WWW-Authenticate\"\n          }), \"헤더로 보내거나 로그인 페이지로 리다이렉트합니다.\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"AccessDeniedException\"\n          }), \"인 경우 \", _jsx(_components.code, {\n            children: \"AccessDeniedHandler\"\n          }), \"가 인증 거부를 처리합니다.\"]\n        }), \"\\n\"]\n      })]\n    });\n  }\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}},"id":"Spring Security Architecture"},"__N_SSG":true},"page":"/blog/[id]","query":{"id":"Spring Security Architecture"},"buildId":"MFOkDCUxJxBF4bROlBGbX","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>