<!DOCTYPE html><html><head><title class="jsx-b1d8888b598bb747">Ordinary</title><meta charSet="utf-8" class="jsx-b1d8888b598bb747"/><meta name="viewport" content="width=device-width, initial-scale=1" class="jsx-b1d8888b598bb747"/><meta name="description" content="Blog" class="jsx-b1d8888b598bb747"/><link rel="icon" href="/favicon.ico" class="jsx-b1d8888b598bb747"/><meta name="next-head-count" content="5"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-9b312e20a4e32339.js" defer=""></script><script src="/_next/static/chunks/framework-82797a600c079ab5.js" defer=""></script><script src="/_next/static/chunks/main-a054bbf31fb90f6a.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c0e324b3689a0aa4.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-7a23590d81cced59.js" defer=""></script><script src="/_next/static/83TotyA5SeDu1ijUHwh-Y/_buildManifest.js" defer=""></script><script src="/_next/static/83TotyA5SeDu1ijUHwh-Y/_ssgManifest.js" defer=""></script><script src="/_next/static/83TotyA5SeDu1ijUHwh-Y/_middlewareManifest.js" defer=""></script><style id="__jsx-b1d8888b598bb747">header.jsx-b1d8888b598bb747{display:grid;
color:#0070f3;
background-color:#1e1e1e;
border-bottom:1px solid #e5e5e5;
grid-template-columns:1fr 1fr;
grid-template-rows:5rem;
position:fixed;
width:100%;
left:25%;
height:5rem;
z-index:300;
opacity:0.95}
.home.jsx-b1d8888b598bb747{font-size:2.5rem;
display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center;
-webkit-text-decoration:none;
text-decoration:none}
.about.jsx-b1d8888b598bb747{font-size:1.5rem;
display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center;
-webkit-flex-direction:row-reverse;
-ms-flex-direction:row-reverse;
flex-direction:row-reverse}
.category.jsx-b1d8888b598bb747{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center;
-webkit-flex-direction:row-reverse;
-ms-flex-direction:row-reverse;
flex-direction:row-reverse}
@media (min-width:720px) {header.jsx-b1d8888b598bb747{max-width:50rem;
padding:0 2rem;
margin:0 auto}}</style><style id="__jsx-506446869">a.jsx-506446869{display:block;
margin-left:0px;
padding-left:0.3rem;
padding-top:0.5rem;
padding-bottom:0.5rem;
width:140px;
-webkit-text-decoration:none;
text-decoration:none;
color:#FFF;
font-size:8pt;
border-bottom:1px solid #ccc;
white-space:nowrap;
text-overflow:ellipsis;
overflow:hidden}
[aria-current].jsx-506446869:not([aria-current="false"]){font-weight:bold;
color:red}</style><style id="__jsx-2105002209">a.jsx-2105002209{display:block;
margin-left:20px;
padding-left:0.3rem;
padding-top:0.5rem;
padding-bottom:0.5rem;
width:120px;
-webkit-text-decoration:none;
text-decoration:none;
color:#FFF;
font-size:8pt;
border-bottom:1px solid #ccc;
white-space:nowrap;
text-overflow:ellipsis;
overflow:hidden}
[aria-current].jsx-2105002209:not([aria-current="false"]){font-weight:bold;
color:red}</style><style id="__jsx-ba6267904dd67a4c">aside.jsx-ba6267904dd67a4c{position:absolute;
right:0;
padding-left:200px;
width:200px;
height:100%}
nav.jsx-ba6267904dd67a4c{top:200px;
padding:0 0 0 10px;
display:inline-block;
position:-webkit-sticky;
position:sticky}
ul.jsx-ba6267904dd67a4c{list-style:none}
@media (max-width:1080px) {aside.jsx-ba6267904dd67a4c{visibility:hidden}}</style><style id="__jsx-66c5b3c4cf32749c">img.jsx-66c5b3c4cf32749c{display:inline;
vertical-align:middle}
span.jsx-66c5b3c4cf32749c{color:#BBBBBB;
padding-left:0.5rem;
display:inline;
vertical-align:middle}</style><style id="__jsx-52f56faf7d264d51">a.jsx-52f56faf7d264d51{color:#62c8f3}</style><style id="__jsx-477b66404f654573">article.jsx-477b66404f654573{display:block;
margin:0 auto;
padding:0 1rem}
h1.jsx-477b66404f654573{font-size:30pt;
margin-bottom:5px}
.head.jsx-477b66404f654573{margin-bottom:2rem}
.container.jsx-477b66404f654573{width:100%;
max-width:720px;
margin:0 auto;
line-height:1.625}
@media (min-width:720px) {.container.jsx-477b66404f654573{padding:0 2rem;
margin:0 auto}}
@media (max-width:800px) {aside.jsx-477b66404f654573{position:static;
height:auto}}</style><style id="__jsx-243dc63d52768b84">.content{max-width:40rem}</style><style id="__jsx-acfe784ee19a4513">.github.jsx-acfe784ee19a4513{font-size:1rem;
display:inline-block;
text-align:center;
width:8rem;
height:2rem;
margin:0 auto}
.github.jsx-acfe784ee19a4513:hover{background-color:#4d4747;
box-shadow:0 0 0.6rem rgb(0 0 0 / 60%);
-webkit-transform:translate(0, -0.4rem);
-moz-transform:translate(0, -0.4rem);
-ms-transform:translate(0, -0.4rem);
transform:translate(0, -0.4rem)}</style><style id="__jsx-75cef58db113c542">footer.jsx-75cef58db113c542{height:6rem;
padding:0 2rem;
text-align:center;
margin:0 auto;
display:grid;
grid-template-columns:1fr 1fr}
span.jsx-75cef58db113c542{font-size:1rem;
padding:2rem 0}
@media (min-width:720px) {footer.jsx-75cef58db113c542{max-width:50rem;
padding:0 2rem;
margin:0 auto}}</style><style id="__jsx-fcc9ccaaf982543f">*{color:white;
box-sizing:border-box}
html, body{padding:0;
margin:0;
font-family:-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;
background:#1e1e1e}
a{color:inherit;
-webkit-text-decoration:none;
text-decoration:none}
main{background:#1e1e1e;
min-height:100vh;
height:100%;
padding:8rem 0 0 0;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center}
strong{color:#a964a7}
code{color:#3fd0c0;
font-weight:bold;
font-family:-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif}
blockquote{border:3px solid #27a9e3;
margin-left:0;
margin-right:0;
padding-left:20px;
padding-right:20px;
border-left:12px solid #27a9e3;
border-radius:5px}
article{position:relative}
.hljs{font-size:0.9rem;
background:#333;
font-family:SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
display:block;
color:#fff;
border-radius:5px;
overflow:auto;
padding:1em;
margin:0.6em}
.hljs-doctag, .hljs-meta-keyword, .hljs-name, .hljs-strong{font-weight:bold}
.hljs-code, .hljs-emphasis{font-style:italic}
.hljs-section, .hljs-tag{color:#62c8f3}
.hljs-selector-class, .hljs-selector-id, .hljs-template-variable, .hljs-variable{color:#ade5fc}
.hljs-meta-string, .hljs-string{color:#a2fca2}
.hljs-attr, .hljs-quote, .hljs-selector-attr{color:#7bd694}
.hljs-tag .hljs-attr{color:inherit}
.hljs-attribute, .hljs-title, .hljs-type{color:#ffa}
.hljs-number, .hljs-symbol{color:#d36363}
.hljs-bullet, .hljs-template-tag{color:#b8d8a2}
.hljs-built_in, .hljs-keyword, .hljs-literal, .hljs-selector-tag{color:#fcc28c}
.hljs-code, .hljs-comment, .hljs-formula{color:#888}
.hljs-link, .hljs-selector-pseudo, .hljs-regexp{color:#c6b4f0}
.hljs-meta{color:#fc9b9b}
.hljs-deletion{background:#fc9b9b;
color:#333}
.hljs-addition{background:#a2fca2;
color:#333}
.hljs-operator, .hljs-params, .hljs-property, .hljs-punctuation{}
.hljs-subst{color:#fff}
.hljs a{color:inherit}
.hljs a:focus, .hljs a:hover{color:inherit;
text-decoration:underline}
.hljs mark{background:#555;
color:inherit}</style></head><body><div id="__next" data-reactroot=""><header class="jsx-b1d8888b598bb747"><div class="jsx-b1d8888b598bb747 home"><a href="/">Ordinary</a></div><div class="jsx-b1d8888b598bb747 about"><a class="jsx-b1d8888b598bb747" href="/about">About</a></div></header><main><div class="jsx-243dc63d52768b84"><div class="jsx-477b66404f654573"><article class="jsx-477b66404f654573 container"><aside class="jsx-ba6267904dd67a4c"><nav class="jsx-ba6267904dd67a4c"><ul class="jsx-ba6267904dd67a4c"><li class="jsx-506446869"><a href="#ëŒ€ëŸ‰ì˜ ë°ì´í„°ë¥¼ Insertí•  ë•Œ" class="jsx-506446869"> <!-- -->ëŒ€ëŸ‰ì˜ ë°ì´í„°ë¥¼ Insertí•  ë•Œ</a></li><li class="jsx-2105002209"><a href="#íŠ¸ëœì­ì…˜ì„ í•˜ë‚˜ë¡œ ë¬¶ê¸°" class="jsx-2105002209"> <!-- -->íŠ¸ëœì­ì…˜ì„ í•˜ë‚˜ë¡œ ë¬¶ê¸°</a></li><li class="jsx-2105002209"><a href="#Bulk insert ì‚¬ìš©í•˜ê¸°" class="jsx-2105002209"> <!-- -->Bulk insert ì‚¬ìš©í•˜ê¸°</a></li><li class="jsx-506446869"><a href="#JPA Bulk Insert" class="jsx-506446869"> <!-- -->JPA Bulk Insert</a></li><li class="jsx-2105002209"><a href="#Batch Size ì„¤ì •" class="jsx-2105002209"> <!-- -->Batch Size ì„¤ì •</a></li><li class="jsx-2105002209"><a href="#order_inserts, order_updates ì„¤ì •" class="jsx-2105002209"> <!-- -->order_inserts, order_updates ì„¤ì •</a></li><li class="jsx-2105002209"><a href="#mysql datasource url ì„¤ì •" class="jsx-2105002209"> <!-- -->mysql datasource url ì„¤ì •</a></li><li class="jsx-506446869"><a href="#Identity ì „ëµ ë¬¸ì œ" class="jsx-506446869"> <!-- -->Identity ì „ëµ ë¬¸ì œ</a></li><li class="jsx-2105002209"><a href="#í•´ê²°ì±… 1. Id ìë™ ìƒì„± ì „ëµ ë³€ê²½" class="jsx-2105002209"> <!-- -->í•´ê²°ì±… 1. Id ìë™ ìƒì„± ì „ëµ ë³€ê²½</a></li><li class="jsx-2105002209"><a href="#í•´ê²°ì±… 2: JDBC ì‚¬ìš©í•˜ê¸°" class="jsx-2105002209"> <!-- -->í•´ê²°ì±… 2: JDBC ì‚¬ìš©í•˜ê¸°</a></li><li class="jsx-506446869"><a href="#ê²°ë¡ " class="jsx-506446869"> <!-- -->ê²°ë¡ </a></li><li class="jsx-2105002209"><a href="#ì°¸ê³ " class="jsx-2105002209"> <!-- -->ì°¸ê³ </a></li></ul></nav></aside><div class="jsx-477b66404f654573 head"><h1 class="jsx-477b66404f654573">JPA Bulk Insert</h1><div class="jsx-66c5b3c4cf32749c"><img src="/profile.png" alt="profile" class="jsx-66c5b3c4cf32749c"/><span class="jsx-66c5b3c4cf32749c">ordilov<!-- --> / <!-- -->2022. 5. 14</span></div></div><div id="ëŒ€ëŸ‰ì˜ ë°ì´í„°ë¥¼ Insertí•  ë•Œ"><h2>ëŒ€ëŸ‰ì˜ ë°ì´í„°ë¥¼ Insertí•  ë•Œ</h2></div>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}">ì ì€ ë°ì´í„°ë¥¼ insert í•œë‹¤ë©´ DBì™€ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì´ ì‹œê°„ì´ ì œì¼ ì˜¤ë˜ ì†Œìš”ë˜ê¸° ë•Œë¬¸ì— ê°œìˆ˜ê°€ ëŠ˜ì–´ë„ í° ì°¨ì´ê°€ ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
í•˜ì§€ë§Œ ëŒ€ëŸ‰ì˜ ë°ì´í„°ë¥¼ ì…ë ¥í•œë‹¤ë©´ ë°©ë²•ì— ë”°ë¼ ì„±ëŠ¥ì´ ë§ì´ ì°¨ì´ë‚  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•œ ê¸°ë³¸ì ì¸ ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<div id="íŠ¸ëœì­ì…˜ì„ í•˜ë‚˜ë¡œ ë¬¶ê¸°"><h3>íŠ¸ëœì­ì…˜ì„ í•˜ë‚˜ë¡œ ë¬¶ê¸°</h3></div>
<pre><code class="hljs language-sql"><span class="hljs-keyword">start</span> transaction;
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> table1 (id, name) <span class="hljs-keyword">values</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;name1&#x27;</span>);
<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> table1 (id, name) <span class="hljs-keyword">values</span> (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;name2&#x27;</span>);
<span class="hljs-keyword">commit</span>;
</code></pre>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}">íŠ¸ëœì­ì…˜ì„ ì—´ê³  ë‹«ëŠ” ë°ë„ ì‹œê°„ì´ ë“¤ê¸° ë•Œë¬¸ì— ì‘ì—…ì„ íŠ¸ëœì­ì…˜ í•˜ë‚˜ë¡œ ë¬¶ì–´ì£¼ë©´ ì¡°ê¸ˆì´ë¼ë„ ì„±ëŠ¥ì´ ì˜¬ë¼ê°‘ë‹ˆë‹¤.</p>
<div id="Bulk insert ì‚¬ìš©í•˜ê¸°"><h3>Bulk insert ì‚¬ìš©í•˜ê¸°</h3></div>
<pre><code class="hljs language-sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> table1 (id, name) <span class="hljs-keyword">values</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;name1&#x27;</span>), (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;name2&#x27;</span>);
</code></pre>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}">MySQLì—ì„œëŠ” Bulk Insertë¼ê³  ë¶ˆë¦¬ëŠ” ë°©ë²•ìœ¼ë¡œ, ì—¬ëŸ¬ rowë¥¼ í•œ ë²ˆì— ì…ë ¥í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.
ì´ë ‡ê²Œ ì—¬ëŸ¬ rowë¥¼ ì…ë ¥í•˜ëŠ” ê²½ìš° unique ì œì•½ì¡°ê±´ì´ë‚˜, ì™¸ë˜ í‚¤ ì œì•½ì¡°ê±´ì„ ì„ì‹œì ìœ¼ë¡œ êº¼ë‘ë©´ ì„±ëŠ¥ì´ ë” ì˜¬ë¼ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-ini">SET <span class="hljs-attr">unique_checks</span>=<span class="hljs-number">0</span><span class="hljs-comment">;</span>
SET <span class="hljs-attr">foreign_key_checks</span>=<span class="hljs-number">0</span><span class="hljs-comment">;</span>

... insert

SET <span class="hljs-attr">unique_checks</span>=<span class="hljs-number">1</span><span class="hljs-comment">;</span>
SET <span class="hljs-attr">foreign_key_checks</span>=<span class="hljs-number">1</span><span class="hljs-comment">;</span>
</code></pre>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}">ì—¬ëŸ¬ rowë¥¼ í•œ ë²ˆì— insertí•˜ëŠ” ê²½ìš°ì— ë°ì´í„° íŒ¨í‚·ì˜ í¬ê¸°ê°€ ë„ˆë¬´ ì»¤ì„œ ëª» ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">show</span> <span class="hljs-keyword">global</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;max_allowed_packet&#x27;</span>
</code></pre>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}">ì´ ë•Œ í•„ìš”í•œë§Œí¼ <code>max_allowed_packet</code> í¬ê¸°ë¥¼ í‚¤ì›Œì£¼ë©´ ë©ë‹ˆë‹¤.</p>
<div id="JPA Bulk Insert"><h2>JPA Bulk Insert</h2></div>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}">JPAì—ëŠ” ëª…ì‹œì ìœ¼ë¡œ bulk insertë¥¼ í•˜ëŠ” ë°©ë²•ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. JPAì—ì„œ insertí•˜ëŠ” ë©”ì†Œë“œëŠ” persist() í•˜ë‚˜ë¡œ, ì»¬ë ‰ì…˜ì„
í•œ ë²ˆì— ì €ì¥í•˜ëŠ” ë°©ë²•ì€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ Data JPAì˜ JpaRepositoryì—ì„œëŠ” saveAll() ë©”ì†Œë“œê°€ ì¡´ì¬í•©ë‹ˆë‹¤.</p>
<pre><code class="hljs language-java"><span class="hljs-meta">@Transactional</span>
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> &lt;S <span class="hljs-keyword">extends</span> <span class="hljs-title class_">T</span>&gt; List&lt;S&gt; <span class="hljs-title function_">saveAll</span><span class="hljs-params">(Iterable&lt;S&gt; entities)</span> {

    Assert.notNull(entities, <span class="hljs-string">&quot;Entities must not be null!&quot;</span>);

    List&lt;S&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();

    <span class="hljs-keyword">for</span> (S entity : entities) {
        result.add(save(entity));
    }

    <span class="hljs-keyword">return</span> result;
}
</code></pre>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}">ë‚´ë¶€ êµ¬í˜„ì„ ì‚´í´ë³´ë©´ saveAll() ë©”ì†Œë“œë„ persistë¥¼ ë°˜ë³µë¬¸ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒìœ¼ë¡œ ë‹¤ë¥¸ ì ì´ ì—†ì–´ ë³´ì…ë‹ˆë‹¤.
ê·¸ëŸ¼ì—ë„ insertë¥¼ ì—¬ëŸ¬ ê°œ í•  ê²½ìš° save() ëŒ€ì‹  saveAll()ì„ ì¨ì•¼í•˜ëŠ” ì´ìœ ê°€ ìˆìŠµë‹ˆë‹¤.</p>
<ul>
<li>ë©”ì†Œë“œë¥¼ ì—¬ëŸ¬ë²ˆ í˜¸ì¶œí•˜ëŠ” ê²ƒê³¼ í•œ ë²ˆ í˜¸ì¶œí•˜ëŠ” ê²ƒë§Œìœ¼ë¡œë„ ì°¨ì´ê°€ ìˆìŠµë‹ˆë‹¤.</li>
<li>@Transactional ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ìƒˆë¡œìš´ íŠ¸ëœì­ì…˜ í˜¸ì¶œì— ë”°ë¥¸ ì‹œê°„ ì°¨ì´ê°€ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}">save() ë©”ì†Œë“œëŠ” @Transactional ì–´ë…¸í…Œì´ì…˜ì´ ì¡´ì¬í•©ë‹ˆë‹¤.
@Transactional ì˜ ê¸°ë³¸ ì „íŒŒ íƒ€ì…ì€ <code>REQUIRED</code>ë¡œ í˜¸ì¶œ ì‹œ ìƒˆë¡œìš´ íŠ¸ëœì­ì…˜ì´ ìƒì„±ë©ë‹ˆë‹¤.
ë”°ë¼ì„œ í˜¸ì¶œ ì‹œë§ˆë‹¤ íŠ¸ëœì­ì…˜ì„ ìƒì„±í•˜ê²Œ ë˜ì–´ ìœ„ì—ì„œ ì„¤ëª…í•œ <strong>íŠ¸ëœì­ì…˜ì„ í•˜ë‚˜ë¡œ ë¬¶ê¸°</strong>ì¡°ì°¨ ì•ˆë˜ëŠ” ìƒíƒœê°€ ë©ë‹ˆë‹¤.
ë°˜ë©´ saveAll()ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° í´ë˜ìŠ¤ ë‚´ë¶€ì—ì„œ save()ë¥¼ í˜¸ì¶œí•˜ê²Œ ë˜ëŠ”ë° ì´ ê²½ìš° Self-Invocationì´ ë°œìƒí•˜ì—¬ íŠ¸ëœì­ì…˜ì´ ìƒì„±ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
ë”°ë¼ì„œ saveAll() ë©”ì†Œë“œì˜ @Transactional ì–´ë…¸í…Œì´ì…˜ì˜ íŠ¸ëœì­ì…˜ë§Œ ìƒì„±ë˜ì–´ íŠ¸ëœì­ì…˜ì´ í•˜ë‚˜ë¡œ ë¬¶ì´ê²Œ ë©ë‹ˆë‹¤.
ì´ ê²°ê³¼ë¡œ 1ë§Œê±´ë§Œ í…ŒìŠ¤íŠ¸í•´ë´ë„ 42ì´ˆì™€ 5ì´ˆ ì°¨ì´ë¡œ í° ì„±ëŠ¥ ì°¨ì´ê°€ ë‚˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}"><img class="content" src="/image/jpa/save_saveall.png" alt="save saveAll ì°¨ì´"/></p>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}">í•˜ì§€ë§Œ hibernateì—ì„œ ìƒì„±ë˜ëŠ” sqlë¬¸ì€ ì—¬ì „íˆ ì—¬ëŸ¬ ê°œì˜ insertë¬¸ì„ ë³´ë‚´ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.</p>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}"><img class="content" src="/image/jpa/insert_many.png" alt="insert ì—¬ëŸ¬ë²ˆ"/></p>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}">bulk insertë¡œ sqlë¬¸ì„ í•˜ë‚˜ë¡œ ë³´ë‚´ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ë ¤ë©´ ëª‡ ê°€ì§€ ì„¤ì •ì´ ë” í•„ìš”í•©ë‹ˆë‹¤.</p>
<div id="Batch Size ì„¤ì •"><h3>Batch Size ì„¤ì •</h3></div>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}"><code>jdbc batch_size</code> ê°’ì„ ì„¤ì •í•˜ë©´ í¬ê¸°ë§Œí¼ sqlë¬¸ì„ ëª¨ì•„ì„œ í•œ ë²ˆì— DB ì„œë²„ì— ìš”ì²­í•©ë‹ˆë‹¤.
<code>batch_size</code>ê°€ ì •í•´ì ¸ìˆëŠ” ì´ìœ ëŠ” ëª¨ë“  ì—”í‹°í‹°ê°€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì˜¬ë¼ê°€ë©´ <code>OutOfMemoryException</code>ì´ ë°œìƒí•  ìˆ˜ ìˆì–´
batch_sizeë¥¼ ê¸°ì¤€ìœ¼ë¡œ flush()ì™€ clear() ì‘ì—…ì„ ì§„í–‰í•´ì„œ ì…ë‹ˆë‹¤.</p>
<pre><code class="hljs language-yaml"><span class="hljs-attr">spring.jpa.properties.hibernate.jdbc.batch_size:</span> <span class="hljs-number">20</span>
</code></pre>
<div id="order_inserts, order_updates ì„¤ì •"><h3>order_inserts, order_updates ì„¤ì •</h3></div>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}">ê°™ì€ í…Œì´ë¸”ì— ëŒ€í•œ insertë‚˜ updateê°€ ëª¨ì—¬ ìˆì§€ ì•Šìœ¼ë©´ batch ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
<code>order_inserts</code> ì™€ <code>order_updates</code>ë¥¼ ì„¤ì¡í•´ì£¼ë©´ ê°™ì€ í…Œì´ë¸”ì— insertë¼ë¦¬ ë¬¶ì–´ì¤ë‹ˆë‹¤.</p>
<pre><code class="hljs language-yml"><span class="hljs-attr">spring.jpa.properties.hibernate.order_inserts:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">spring.jpa.properties.hibernate.order_updates:</span> <span class="hljs-literal">true</span>
</code></pre>
<div id="mysql datasource url ì„¤ì •"><h3>mysql datasource url ì„¤ì •</h3></div>
<pre><code class="hljs language-bash">spring.datasource.url: jdbc:mysql://localhost:3306/test?rewriteBatchedStatements=<span class="hljs-literal">true</span>&amp;profileSQL=<span class="hljs-literal">true</span>&amp;logger=Slf4JLogger
</code></pre>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}"><code>rewriteBatchedStatements</code> ì˜µì…˜ì„ ì ìš©í•´ì£¼ë©´ ì—¬ëŸ¬ insert ì¿¼ë¦¬ë¥¼ bulk insert ë°©ì‹ìœ¼ë¡œ ì¬ì‘ì„±í•´ì¤ë‹ˆë‹¤.
ì´ë ‡ê²Œ ì¬ì‘ì„±ëœ ì¿¼ë¦¬ëŠ” Hibernateì— ì°íˆëŠ” SQL ë¡œê·¸ì™€ ë‹¬ë¼ì§€ëŠ”ë° ë°”ë€ ì¿¼ë¦¬ë¥¼ ë³´ê³  ì‹¶ì€ ê²½ìš°
<code>profileSQL=true</code> ë¥¼ ì¶”ê°€í•´ì£¼ë©´ ì‹¤ì œ mysql ì¿¼ë¦¬ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs language-sql">Hibernate: <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> <span class="hljs-keyword">member</span> (name, id) <span class="hljs-keyword">values</span> (?, ?)
Hibernate: <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> <span class="hljs-keyword">member</span> (name, id) <span class="hljs-keyword">values</span> (?, ?)
Hibernate: <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> <span class="hljs-keyword">member</span> (name, id) <span class="hljs-keyword">values</span> (?, ?)
Mon May <span class="hljs-number">16</span> <span class="hljs-number">17</span>:<span class="hljs-number">08</span>:<span class="hljs-number">39</span> KST <span class="hljs-number">2022</span> INFO: [QUERY] <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> <span class="hljs-keyword">member</span> (name, id) <span class="hljs-keyword">values</span> (<span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-number">1</span>),(<span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-number">2</span>),(<span class="hljs-string">&#x27;2&#x27;</span>, <span class="hljs-number">3</span>)
</code></pre>
<div id="Identity ì „ëµ ë¬¸ì œ"><h2>Identity ì „ëµ ë¬¸ì œ</h2></div>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}">MySQLì—ì„œ Id ìë™ ìƒì„± ì „ëµì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° Identity ì „ëµì„ ì£¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.
ë¬¸ì œëŠ” Identity ì „ëµì˜ ê²½ìš° ë‹¤ìŒ Idë¥¼ ë°›ì•„ì˜¤ê¸° ìœ„í•´ì„œ insertë¥¼ í•´ì•¼í•˜ê¸° ë•Œë¬¸ì— bulk insert ì‘ì—…ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
ë”°ë¼ì„œ bulk insertë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ 2ê°€ì§€ í•´ê²°ì±…ì´ ìˆìŠµë‹ˆë‹¤.</p>
<div id="í•´ê²°ì±… 1. Id ìë™ ìƒì„± ì „ëµ ë³€ê²½"><h3>í•´ê²°ì±… 1. Id ìë™ ìƒì„± ì „ëµ ë³€ê²½</h3></div>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}">Id ìë™ ì „ëµì„ Sequence ì „ëµì´ë‚˜ Table ì „ëµìœ¼ë¡œ ë³€ê²½í•˜ë©´ bulk insertê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.
í•˜ì§€ë§Œ ë‹¨ìˆœíˆ Sequence ì „ëµìœ¼ë¡œ ë°”ê¾¸ê¸°ë§Œ í•˜ë©´ ì„±ëŠ¥ì€ ë” ì•ˆ ì¢‹ì•„ì§€ê²Œ ë©ë‹ˆë‹¤.
Sequence ì „ëµì„ ì‚¬ìš©í•˜ë©´ insertí•˜ê¸° ì „ì— ë‹¤ìŒ idë¥¼ ì°¾ëŠ” selectë¬¸ê³¼ ë‹¤ìŒ idë¥¼ ì„¤ì •í•˜ëŠ” updateë¬¸ì´ ë‚˜ê°€ê²Œ ë©ë‹ˆë‹¤.</p>
<pre><code class="hljs language-vbnet"><span class="hljs-symbol">Hibernate:</span> <span class="hljs-keyword">select</span> next_val <span class="hljs-keyword">as</span> id_val <span class="hljs-keyword">from</span> hibernate_sequence <span class="hljs-keyword">for</span> update
<span class="hljs-symbol">Hibernate:</span> update hibernate_sequence <span class="hljs-keyword">set</span> next_val= ? <span class="hljs-keyword">where</span> next_val=?
</code></pre>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}">ê¸°ë³¸ id ìƒì„±ì€ í•˜ë‚˜ì”© ìƒì„±ë˜ê¸° ë•Œë¬¸ì— insertí•˜ê¸° ì „ì— ë§¤ë²ˆ ë‘ ê°œì˜ ì¿¼ë¦¬ê°€ ë” ë‚˜ê°€ê²Œ ë©ë‹ˆë‹¤.
ë”°ë¼ì„œ ìƒì„±í•´ì„œ ì‚¬ìš©í•  Id ë²”ìœ„ë¥¼ ì§€ì •í•´ì¤˜ì•¼í•©ë‹ˆë‹¤.</p>
<pre><code class="hljs language-java"><span class="hljs-meta">@Id</span>
<span class="hljs-meta">@GenericGenerator(
        name = &quot;sequence-generator&quot;,
        strategy = &quot;org.hibernate.id.enhanced.SequenceStyleGenerator&quot;,
        parameters = {
                @Parameter(name = &quot;sequence_name&quot;, value = &quot;hibernate_sequence&quot;),
                @Parameter(name = &quot;optimizer&quot;, value = &quot;pooled&quot;),
                @Parameter(name = &quot;initial_value&quot;, value = &quot;1&quot;),
                @Parameter(name = &quot;increment_size&quot;, value = &quot;100&quot;)
        }
)</span>
<span class="hljs-meta">@GeneratedValue(
        strategy = GenerationType.SEQUENCE,
        generator = &quot;SequenceGenerator&quot;
)</span>
<span class="hljs-keyword">private</span> Long id;
</code></pre>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}"><code>increment_size</code>ë¥¼ ì§€ì •í•´ì£¼ì–´ í¬ê¸°ë§Œí¼ì˜ idëŠ” ì¡°íšŒë‚˜ ì—…ë°ì´íŠ¸ ì—†ì´ ìƒì„±í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.</p>
<div id="í•´ê²°ì±… 2: JDBC ì‚¬ìš©í•˜ê¸°"><h3>í•´ê²°ì±… 2: JDBC ì‚¬ìš©í•˜ê¸°</h3></div>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}">JPAë¥¼ ê¼­ ì¨ì•¼ë§Œ í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼ë©´ bulk insert ì‘ì—…ì„ JDBCë¡œ ë¶„ë¦¬í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
jdbcTemplateì˜ batchUpdate() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ bulk insertê°€ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤.</p>
<pre><code class="hljs language-java">jdbcTemplate.batchUpdate(<span class="hljs-string">&quot;INSERT INTO MEMBER(`NAME`) VALUES(?)&quot;</span>,
<span class="hljs-keyword">new</span> <span class="hljs-title class_">BatchPreparedStatementSetter</span>() {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setValues</span><span class="hljs-params">(PreparedStatement ps, <span class="hljs-type">int</span> i)</span> <span class="hljs-keyword">throws</span> SQLException {
        ps.setString(<span class="hljs-number">1</span>, <span class="hljs-string">&quot;member&quot;</span> + i);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getBatchSize</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-number">1000</span>;
    }
});
</code></pre>
<div id="ê²°ë¡ "><h2>ê²°ë¡ </h2></div>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}">JPAë¡œë§Œ ì‘ì„±í•œë‹¤ë©´ í‚¤ ìë™ ìƒì„± ì „ëµì„ ë°”ê¾¸ëŠ” ê²Œ ì¢‹ìŠµë‹ˆë‹¤.
í•˜ì§€ë§Œ JDBCë¥¼ ì‚¬ìš©í•œë‹¤ë©´ í‚¤ ìë™ ìƒì„± ì „ëµì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆê³  ì„±ëŠ¥ë„ ì „ë°˜ì ìœ¼ë¡œ ë” ë¹¨ëìŠµë‹ˆë‹¤.
ë‹¤ë¥¸ DBë¥¼ ì“°ê±°ë‚˜ ì„¤ì •ì´ ë‹¬ë¼ì§„ë‹¤ë©´ ê²°ê³¼ê°€ ë‹¤ë¥¼ ìˆ˜ ìˆì§€ë§Œ MySQL ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„° í¬ê¸°ê°€ ì»¤ì§ˆìˆ˜ë¡
JDBC ìª½ì´ ì„±ëŠ¥ì´ ë” ì¢‹ì€ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.
ë¬¼ë¡  ë‘ ë°©ë²• ì–´ëŠ ìª½ì„ ì‚¬ìš©í•˜ë”ë¼ë„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ìª½ì— ë¹„í•´ í° ì„±ëŠ¥ ì°¨ì´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p class=".Paragraph.jsx-c13bd6d988b6c83{line-height:1.625}"><img class="content" src="/image/jpa/insert_difference.png" alt="ì„±ëŠ¥ ì°¨ì´"/></p>
<div id="ì°¸ê³ "><h3>ì°¸ê³ </h3></div>
<ul>
<li><a class="jsx-52f56faf7d264d51">https://jaehun2841.github.io/2020/11/22/2020-11-22-spring-data-jpa-batch-insert/#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0</a></li>
<li><a class="jsx-52f56faf7d264d51">https://homoefficio.github.io/2020/01/25/Spring-Data%EC%97%90%EC%84%9C-Batch-Insert-%EC%B5%9C%EC%A0%81%ED%99%94/</a></li>
<li><a class="jsx-52f56faf7d264d51">https://www.baeldung.com/spring-data-save-saveall</a></li>
</ul></article></div></div></main><footer class="jsx-75cef58db113c542"><span class="jsx-75cef58db113c542"><a href="https://github.com/ordilov" class="jsx-acfe784ee19a4513 github">Github ğŸ”—</a></span><span class="jsx-75cef58db113c542">Copyright Â© Ordilov</span></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"metadata":{"layout":"post","title":"JPA Bulk Insert","date":"2022-05-15 00:01:00 +0900","category":"spring","tags":["backend"],"keywords":["backend"],"description":"JPAì—ì„œ MySQLì˜ Bulk Insertë¥¼ í•˜ëŠ” ë²•ì„ ì•Œì•„ë´…ë‹ˆë‹¤.","id":"JPA Bulk Insert"},"mdxSource":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, {})\n  })) : _createMdxContent();\n  function _createMdxContent() {\n    const _components = Object.assign({\n      h2: \"h2\",\n      p: \"p\",\n      h3: \"h3\",\n      pre: \"pre\",\n      code: \"code\",\n      span: \"span\",\n      ul: \"ul\",\n      li: \"li\",\n      strong: \"strong\",\n      img: \"img\",\n      a: \"a\"\n    }, _provideComponents(), props.components);\n    return _jsxs(_Fragment, {\n      children: [_jsx(_components.h2, {\n        children: \"ëŒ€ëŸ‰ì˜ ë°ì´í„°ë¥¼ Insertí•  ë•Œ\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"ì ì€ ë°ì´í„°ë¥¼ insert í•œë‹¤ë©´ DBì™€ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì´ ì‹œê°„ì´ ì œì¼ ì˜¤ë˜ ì†Œìš”ë˜ê¸° ë•Œë¬¸ì— ê°œìˆ˜ê°€ ëŠ˜ì–´ë„ í° ì°¨ì´ê°€ ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\\ní•˜ì§€ë§Œ ëŒ€ëŸ‰ì˜ ë°ì´í„°ë¥¼ ì…ë ¥í•œë‹¤ë©´ ë°©ë²•ì— ë”°ë¼ ì„±ëŠ¥ì´ ë§ì´ ì°¨ì´ë‚  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\\nì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•œ ê¸°ë³¸ì ì¸ ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\"\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"íŠ¸ëœì­ì…˜ì„ í•˜ë‚˜ë¡œ ë¬¶ê¸°\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-sql\",\n          children: [_jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"start\"\n          }), \" transaction;\\n\", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"insert\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"into\"\n          }), \" table1 (id, name) \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"values\"\n          }), \" (\", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"1\"\n          }), \", \", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"'name1'\"\n          }), \");\\n\", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"insert\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"into\"\n          }), \" table1 (id, name) \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"values\"\n          }), \" (\", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"2\"\n          }), \", \", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"'name2'\"\n          }), \");\\n\", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"commit\"\n          }), \";\\n\"]\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"íŠ¸ëœì­ì…˜ì„ ì—´ê³  ë‹«ëŠ” ë°ë„ ì‹œê°„ì´ ë“¤ê¸° ë•Œë¬¸ì— ì‘ì—…ì„ íŠ¸ëœì­ì…˜ í•˜ë‚˜ë¡œ ë¬¶ì–´ì£¼ë©´ ì¡°ê¸ˆì´ë¼ë„ ì„±ëŠ¥ì´ ì˜¬ë¼ê°‘ë‹ˆë‹¤.\"\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"Bulk insert ì‚¬ìš©í•˜ê¸°\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-sql\",\n          children: [_jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"insert\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"into\"\n          }), \" table1 (id, name) \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"values\"\n          }), \" (\", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"1\"\n          }), \", \", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"'name1'\"\n          }), \"), (\", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"2\"\n          }), \", \", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"'name2'\"\n          }), \");\\n\"]\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"MySQLì—ì„œëŠ” Bulk Insertë¼ê³  ë¶ˆë¦¬ëŠ” ë°©ë²•ìœ¼ë¡œ, ì—¬ëŸ¬ rowë¥¼ í•œ ë²ˆì— ì…ë ¥í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.\\nì´ë ‡ê²Œ ì—¬ëŸ¬ rowë¥¼ ì…ë ¥í•˜ëŠ” ê²½ìš° unique ì œì•½ì¡°ê±´ì´ë‚˜, ì™¸ë˜ í‚¤ ì œì•½ì¡°ê±´ì„ ì„ì‹œì ìœ¼ë¡œ êº¼ë‘ë©´ ì„±ëŠ¥ì´ ë” ì˜¬ë¼ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-ini\",\n          children: [\"SET \", _jsx(_components.span, {\n            className: \"hljs-attr\",\n            children: \"unique_checks\"\n          }), \"=\", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \";\"\n          }), \"\\nSET \", _jsx(_components.span, {\n            className: \"hljs-attr\",\n            children: \"foreign_key_checks\"\n          }), \"=\", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \";\"\n          }), \"\\n\\n... insert\\n\\nSET \", _jsx(_components.span, {\n            className: \"hljs-attr\",\n            children: \"unique_checks\"\n          }), \"=\", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \";\"\n          }), \"\\nSET \", _jsx(_components.span, {\n            className: \"hljs-attr\",\n            children: \"foreign_key_checks\"\n          }), \"=\", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \";\"\n          }), \"\\n\"]\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"ì—¬ëŸ¬ rowë¥¼ í•œ ë²ˆì— insertí•˜ëŠ” ê²½ìš°ì— ë°ì´í„° íŒ¨í‚·ì˜ í¬ê¸°ê°€ ë„ˆë¬´ ì»¤ì„œ ëª» ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-sql\",\n          children: [_jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"show\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"global\"\n          }), \" variables \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"like\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"'max_allowed_packet'\"\n          }), \"\\n\"]\n        })\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"ì´ ë•Œ í•„ìš”í•œë§Œí¼ \", _jsx(_components.code, {\n          children: \"max_allowed_packet\"\n        }), \" í¬ê¸°ë¥¼ í‚¤ì›Œì£¼ë©´ ë©ë‹ˆë‹¤.\"]\n      }), \"\\n\", _jsx(_components.h2, {\n        children: \"JPA Bulk Insert\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"JPAì—ëŠ” ëª…ì‹œì ìœ¼ë¡œ bulk insertë¥¼ í•˜ëŠ” ë°©ë²•ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. JPAì—ì„œ insertí•˜ëŠ” ë©”ì†Œë“œëŠ” persist() í•˜ë‚˜ë¡œ, ì»¬ë ‰ì…˜ì„\\ní•œ ë²ˆì— ì €ì¥í•˜ëŠ” ë°©ë²•ì€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ Data JPAì˜ JpaRepositoryì—ì„œëŠ” saveAll() ë©”ì†Œë“œê°€ ì¡´ì¬í•©ë‹ˆë‹¤.\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-java\",\n          children: [_jsx(_components.span, {\n            className: \"hljs-meta\",\n            children: \"@Transactional\"\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"hljs-meta\",\n            children: \"@Override\"\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"public\"\n          }), \" \u003cS \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"extends\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-title class_\",\n            children: \"T\"\n          }), \"\u003e List\u003cS\u003e \", _jsx(_components.span, {\n            className: \"hljs-title function_\",\n            children: \"saveAll\"\n          }), _jsx(_components.span, {\n            className: \"hljs-params\",\n            children: \"(Iterable\u003cS\u003e entities)\"\n          }), \" {\\n\\n    Assert.notNull(entities, \", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"Entities must not be null!\\\"\"\n          }), \");\\n\\n    List\u003cS\u003e result = \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"new\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-title class_\",\n            children: \"ArrayList\"\n          }), \"\u003c\u003e();\\n\\n    \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"for\"\n          }), \" (S entity : entities) {\\n        result.add(save(entity));\\n    }\\n\\n    \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"return\"\n          }), \" result;\\n}\\n\"]\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"ë‚´ë¶€ êµ¬í˜„ì„ ì‚´í´ë³´ë©´ saveAll() ë©”ì†Œë“œë„ persistë¥¼ ë°˜ë³µë¬¸ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒìœ¼ë¡œ ë‹¤ë¥¸ ì ì´ ì—†ì–´ ë³´ì…ë‹ˆë‹¤.\\nê·¸ëŸ¼ì—ë„ insertë¥¼ ì—¬ëŸ¬ ê°œ í•  ê²½ìš° save() ëŒ€ì‹  saveAll()ì„ ì¨ì•¼í•˜ëŠ” ì´ìœ ê°€ ìˆìŠµë‹ˆë‹¤.\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsx(_components.li, {\n          children: \"ë©”ì†Œë“œë¥¼ ì—¬ëŸ¬ë²ˆ í˜¸ì¶œí•˜ëŠ” ê²ƒê³¼ í•œ ë²ˆ í˜¸ì¶œí•˜ëŠ” ê²ƒë§Œìœ¼ë¡œë„ ì°¨ì´ê°€ ìˆìŠµë‹ˆë‹¤.\"\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"@Transactional ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ìƒˆë¡œìš´ íŠ¸ëœì­ì…˜ í˜¸ì¶œì— ë”°ë¥¸ ì‹œê°„ ì°¨ì´ê°€ ìˆìŠµë‹ˆë‹¤.\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"save() ë©”ì†Œë“œëŠ” @Transactional ì–´ë…¸í…Œì´ì…˜ì´ ì¡´ì¬í•©ë‹ˆë‹¤.\\n@Transactional ì˜ ê¸°ë³¸ ì „íŒŒ íƒ€ì…ì€ \", _jsx(_components.code, {\n          children: \"REQUIRED\"\n        }), \"ë¡œ í˜¸ì¶œ ì‹œ ìƒˆë¡œìš´ íŠ¸ëœì­ì…˜ì´ ìƒì„±ë©ë‹ˆë‹¤.\\në”°ë¼ì„œ í˜¸ì¶œ ì‹œë§ˆë‹¤ íŠ¸ëœì­ì…˜ì„ ìƒì„±í•˜ê²Œ ë˜ì–´ ìœ„ì—ì„œ ì„¤ëª…í•œ \", _jsx(_components.strong, {\n          children: \"íŠ¸ëœì­ì…˜ì„ í•˜ë‚˜ë¡œ ë¬¶ê¸°\"\n        }), \"ì¡°ì°¨ ì•ˆë˜ëŠ” ìƒíƒœê°€ ë©ë‹ˆë‹¤.\\në°˜ë©´ saveAll()ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° í´ë˜ìŠ¤ ë‚´ë¶€ì—ì„œ save()ë¥¼ í˜¸ì¶œí•˜ê²Œ ë˜ëŠ”ë° ì´ ê²½ìš° Self-Invocationì´ ë°œìƒí•˜ì—¬ íŠ¸ëœì­ì…˜ì´ ìƒì„±ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\\në”°ë¼ì„œ saveAll() ë©”ì†Œë“œì˜ @Transactional ì–´ë…¸í…Œì´ì…˜ì˜ íŠ¸ëœì­ì…˜ë§Œ ìƒì„±ë˜ì–´ íŠ¸ëœì­ì…˜ì´ í•˜ë‚˜ë¡œ ë¬¶ì´ê²Œ ë©ë‹ˆë‹¤.\\nì´ ê²°ê³¼ë¡œ 1ë§Œê±´ë§Œ í…ŒìŠ¤íŠ¸í•´ë´ë„ 42ì´ˆì™€ 5ì´ˆ ì°¨ì´ë¡œ í° ì„±ëŠ¥ ì°¨ì´ê°€ ë‚˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: _jsx(_components.img, {\n          src: \"/image/jpa/save_saveall.png\",\n          alt: \"save saveAll ì°¨ì´\"\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"í•˜ì§€ë§Œ hibernateì—ì„œ ìƒì„±ë˜ëŠ” sqlë¬¸ì€ ì—¬ì „íˆ ì—¬ëŸ¬ ê°œì˜ insertë¬¸ì„ ë³´ë‚´ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: _jsx(_components.img, {\n          src: \"/image/jpa/insert_many.png\",\n          alt: \"insert ì—¬ëŸ¬ë²ˆ\"\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"bulk insertë¡œ sqlë¬¸ì„ í•˜ë‚˜ë¡œ ë³´ë‚´ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ë ¤ë©´ ëª‡ ê°€ì§€ ì„¤ì •ì´ ë” í•„ìš”í•©ë‹ˆë‹¤.\"\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"Batch Size ì„¤ì •\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [_jsx(_components.code, {\n          children: \"jdbc batch_size\"\n        }), \" ê°’ì„ ì„¤ì •í•˜ë©´ í¬ê¸°ë§Œí¼ sqlë¬¸ì„ ëª¨ì•„ì„œ í•œ ë²ˆì— DB ì„œë²„ì— ìš”ì²­í•©ë‹ˆë‹¤.\\n\", _jsx(_components.code, {\n          children: \"batch_size\"\n        }), \"ê°€ ì •í•´ì ¸ìˆëŠ” ì´ìœ ëŠ” ëª¨ë“  ì—”í‹°í‹°ê°€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì˜¬ë¼ê°€ë©´ \", _jsx(_components.code, {\n          children: \"OutOfMemoryException\"\n        }), \"ì´ ë°œìƒí•  ìˆ˜ ìˆì–´\\nbatch_sizeë¥¼ ê¸°ì¤€ìœ¼ë¡œ flush()ì™€ clear() ì‘ì—…ì„ ì§„í–‰í•´ì„œ ì…ë‹ˆë‹¤.\"]\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-yaml\",\n          children: [_jsx(_components.span, {\n            className: \"hljs-attr\",\n            children: \"spring.jpa.properties.hibernate.jdbc.batch_size:\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"20\"\n          }), \"\\n\"]\n        })\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"order_inserts, order_updates ì„¤ì •\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"ê°™ì€ í…Œì´ë¸”ì— ëŒ€í•œ insertë‚˜ updateê°€ ëª¨ì—¬ ìˆì§€ ì•Šìœ¼ë©´ batch ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\\n\", _jsx(_components.code, {\n          children: \"order_inserts\"\n        }), \" ì™€ \", _jsx(_components.code, {\n          children: \"order_updates\"\n        }), \"ë¥¼ ì„¤ì¡í•´ì£¼ë©´ ê°™ì€ í…Œì´ë¸”ì— insertë¼ë¦¬ ë¬¶ì–´ì¤ë‹ˆë‹¤.\"]\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-yml\",\n          children: [_jsx(_components.span, {\n            className: \"hljs-attr\",\n            children: \"spring.jpa.properties.hibernate.order_inserts:\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-literal\",\n            children: \"true\"\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"hljs-attr\",\n            children: \"spring.jpa.properties.hibernate.order_updates:\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-literal\",\n            children: \"true\"\n          }), \"\\n\"]\n        })\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"mysql datasource url ì„¤ì •\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-bash\",\n          children: [\"spring.datasource.url: jdbc:mysql://localhost:3306/test?rewriteBatchedStatements=\", _jsx(_components.span, {\n            className: \"hljs-literal\",\n            children: \"true\"\n          }), \"\u0026profileSQL=\", _jsx(_components.span, {\n            className: \"hljs-literal\",\n            children: \"true\"\n          }), \"\u0026logger=Slf4JLogger\\n\"]\n        })\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [_jsx(_components.code, {\n          children: \"rewriteBatchedStatements\"\n        }), \" ì˜µì…˜ì„ ì ìš©í•´ì£¼ë©´ ì—¬ëŸ¬ insert ì¿¼ë¦¬ë¥¼ bulk insert ë°©ì‹ìœ¼ë¡œ ì¬ì‘ì„±í•´ì¤ë‹ˆë‹¤.\\nì´ë ‡ê²Œ ì¬ì‘ì„±ëœ ì¿¼ë¦¬ëŠ” Hibernateì— ì°íˆëŠ” SQL ë¡œê·¸ì™€ ë‹¬ë¼ì§€ëŠ”ë° ë°”ë€ ì¿¼ë¦¬ë¥¼ ë³´ê³  ì‹¶ì€ ê²½ìš°\\n\", _jsx(_components.code, {\n          children: \"profileSQL=true\"\n        }), \" ë¥¼ ì¶”ê°€í•´ì£¼ë©´ ì‹¤ì œ mysql ì¿¼ë¦¬ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"]\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-sql\",\n          children: [\"Hibernate: \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"insert\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"into\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"member\"\n          }), \" (name, id) \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"values\"\n          }), \" (?, ?)\\nHibernate: \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"insert\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"into\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"member\"\n          }), \" (name, id) \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"values\"\n          }), \" (?, ?)\\nHibernate: \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"insert\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"into\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"member\"\n          }), \" (name, id) \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"values\"\n          }), \" (?, ?)\\nMon May \", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"16\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"17\"\n          }), \":\", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"08\"\n          }), \":\", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"39\"\n          }), \" KST \", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"2022\"\n          }), \" INFO: [QUERY] \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"insert\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"into\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"member\"\n          }), \" (name, id) \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"values\"\n          }), \" (\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"'0'\"\n          }), \", \", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"1\"\n          }), \"),(\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"'1'\"\n          }), \", \", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"2\"\n          }), \"),(\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"'2'\"\n          }), \", \", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"3\"\n          }), \")\\n\"]\n        })\n      }), \"\\n\", _jsx(_components.h2, {\n        children: \"Identity ì „ëµ ë¬¸ì œ\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"MySQLì—ì„œ Id ìë™ ìƒì„± ì „ëµì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° Identity ì „ëµì„ ì£¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.\\në¬¸ì œëŠ” Identity ì „ëµì˜ ê²½ìš° ë‹¤ìŒ Idë¥¼ ë°›ì•„ì˜¤ê¸° ìœ„í•´ì„œ insertë¥¼ í•´ì•¼í•˜ê¸° ë•Œë¬¸ì— bulk insert ì‘ì—…ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\\në”°ë¼ì„œ bulk insertë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ 2ê°€ì§€ í•´ê²°ì±…ì´ ìˆìŠµë‹ˆë‹¤.\"\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"í•´ê²°ì±… 1. Id ìë™ ìƒì„± ì „ëµ ë³€ê²½\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Id ìë™ ì „ëµì„ Sequence ì „ëµì´ë‚˜ Table ì „ëµìœ¼ë¡œ ë³€ê²½í•˜ë©´ bulk insertê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.\\ní•˜ì§€ë§Œ ë‹¨ìˆœíˆ Sequence ì „ëµìœ¼ë¡œ ë°”ê¾¸ê¸°ë§Œ í•˜ë©´ ì„±ëŠ¥ì€ ë” ì•ˆ ì¢‹ì•„ì§€ê²Œ ë©ë‹ˆë‹¤.\\nSequence ì „ëµì„ ì‚¬ìš©í•˜ë©´ insertí•˜ê¸° ì „ì— ë‹¤ìŒ idë¥¼ ì°¾ëŠ” selectë¬¸ê³¼ ë‹¤ìŒ idë¥¼ ì„¤ì •í•˜ëŠ” updateë¬¸ì´ ë‚˜ê°€ê²Œ ë©ë‹ˆë‹¤.\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-vbnet\",\n          children: [_jsx(_components.span, {\n            className: \"hljs-symbol\",\n            children: \"Hibernate:\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"select\"\n          }), \" next_val \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"as\"\n          }), \" id_val \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"from\"\n          }), \" hibernate_sequence \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"for\"\n          }), \" update\\n\", _jsx(_components.span, {\n            className: \"hljs-symbol\",\n            children: \"Hibernate:\"\n          }), \" update hibernate_sequence \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"set\"\n          }), \" next_val= ? \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"where\"\n          }), \" next_val=?\\n\"]\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"ê¸°ë³¸ id ìƒì„±ì€ í•˜ë‚˜ì”© ìƒì„±ë˜ê¸° ë•Œë¬¸ì— insertí•˜ê¸° ì „ì— ë§¤ë²ˆ ë‘ ê°œì˜ ì¿¼ë¦¬ê°€ ë” ë‚˜ê°€ê²Œ ë©ë‹ˆë‹¤.\\në”°ë¼ì„œ ìƒì„±í•´ì„œ ì‚¬ìš©í•  Id ë²”ìœ„ë¥¼ ì§€ì •í•´ì¤˜ì•¼í•©ë‹ˆë‹¤.\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-java\",\n          children: [_jsx(_components.span, {\n            className: \"hljs-meta\",\n            children: \"@Id\"\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"hljs-meta\",\n            children: \"@GenericGenerator(\\n        name = \\\"sequence-generator\\\",\\n        strategy = \\\"org.hibernate.id.enhanced.SequenceStyleGenerator\\\",\\n        parameters = {\\n                @Parameter(name = \\\"sequence_name\\\", value = \\\"hibernate_sequence\\\"),\\n                @Parameter(name = \\\"optimizer\\\", value = \\\"pooled\\\"),\\n                @Parameter(name = \\\"initial_value\\\", value = \\\"1\\\"),\\n                @Parameter(name = \\\"increment_size\\\", value = \\\"100\\\")\\n        }\\n)\"\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"hljs-meta\",\n            children: \"@GeneratedValue(\\n        strategy = GenerationType.SEQUENCE,\\n        generator = \\\"SequenceGenerator\\\"\\n)\"\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"private\"\n          }), \" Long id;\\n\"]\n        })\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [_jsx(_components.code, {\n          children: \"increment_size\"\n        }), \"ë¥¼ ì§€ì •í•´ì£¼ì–´ í¬ê¸°ë§Œí¼ì˜ idëŠ” ì¡°íšŒë‚˜ ì—…ë°ì´íŠ¸ ì—†ì´ ìƒì„±í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.\"]\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"í•´ê²°ì±… 2: JDBC ì‚¬ìš©í•˜ê¸°\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"JPAë¥¼ ê¼­ ì¨ì•¼ë§Œ í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼ë©´ bulk insert ì‘ì—…ì„ JDBCë¡œ ë¶„ë¦¬í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.\\njdbcTemplateì˜ batchUpdate() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ bulk insertê°€ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤.\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-java\",\n          children: [\"jdbcTemplate.batchUpdate(\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"INSERT INTO MEMBER(`NAME`) VALUES(?)\\\"\"\n          }), \",\\n\", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"new\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-title class_\",\n            children: \"BatchPreparedStatementSetter\"\n          }), \"() {\\n    \", _jsx(_components.span, {\n            className: \"hljs-meta\",\n            children: \"@Override\"\n          }), \"\\n    \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"public\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"void\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-title function_\",\n            children: \"setValues\"\n          }), _jsxs(_components.span, {\n            className: \"hljs-params\",\n            children: [\"(PreparedStatement ps, \", _jsx(_components.span, {\n              className: \"hljs-type\",\n              children: \"int\"\n            }), \" i)\"]\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"throws\"\n          }), \" SQLException {\\n        ps.setString(\", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"1\"\n          }), \", \", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"member\\\"\"\n          }), \" + i);\\n    }\\n\\n    \", _jsx(_components.span, {\n            className: \"hljs-meta\",\n            children: \"@Override\"\n          }), \"\\n    \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"public\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"int\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-title function_\",\n            children: \"getBatchSize\"\n          }), _jsx(_components.span, {\n            className: \"hljs-params\",\n            children: \"()\"\n          }), \" {\\n        \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"return\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"1000\"\n          }), \";\\n    }\\n});\\n\"]\n        })\n      }), \"\\n\", _jsx(_components.h2, {\n        children: \"ê²°ë¡ \"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"JPAë¡œë§Œ ì‘ì„±í•œë‹¤ë©´ í‚¤ ìë™ ìƒì„± ì „ëµì„ ë°”ê¾¸ëŠ” ê²Œ ì¢‹ìŠµë‹ˆë‹¤.\\ní•˜ì§€ë§Œ JDBCë¥¼ ì‚¬ìš©í•œë‹¤ë©´ í‚¤ ìë™ ìƒì„± ì „ëµì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆê³  ì„±ëŠ¥ë„ ì „ë°˜ì ìœ¼ë¡œ ë” ë¹¨ëìŠµë‹ˆë‹¤.\\në‹¤ë¥¸ DBë¥¼ ì“°ê±°ë‚˜ ì„¤ì •ì´ ë‹¬ë¼ì§„ë‹¤ë©´ ê²°ê³¼ê°€ ë‹¤ë¥¼ ìˆ˜ ìˆì§€ë§Œ MySQL ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„° í¬ê¸°ê°€ ì»¤ì§ˆìˆ˜ë¡\\nJDBC ìª½ì´ ì„±ëŠ¥ì´ ë” ì¢‹ì€ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.\\në¬¼ë¡  ë‘ ë°©ë²• ì–´ëŠ ìª½ì„ ì‚¬ìš©í•˜ë”ë¼ë„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ìª½ì— ë¹„í•´ í° ì„±ëŠ¥ ì°¨ì´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: _jsx(_components.img, {\n          src: \"/image/jpa/insert_difference.png\",\n          alt: \"ì„±ëŠ¥ ì°¨ì´\"\n        })\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"ì°¸ê³ \"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsx(_components.li, {\n          children: _jsx(_components.a, {\n            href: \"https://jaehun2841.github.io/2020/11/22/2020-11-22-spring-data-jpa-batch-insert/#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0\",\n            children: \"https://jaehun2841.github.io/2020/11/22/2020-11-22-spring-data-jpa-batch-insert/#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0\"\n          })\n        }), \"\\n\", _jsx(_components.li, {\n          children: _jsx(_components.a, {\n            href: \"https://homoefficio.github.io/2020/01/25/Spring-Data%EC%97%90%EC%84%9C-Batch-Insert-%EC%B5%9C%EC%A0%81%ED%99%94/\",\n            children: \"https://homoefficio.github.io/2020/01/25/Spring-Data%EC%97%90%EC%84%9C-Batch-Insert-%EC%B5%9C%EC%A0%81%ED%99%94/\"\n          })\n        }), \"\\n\", _jsx(_components.li, {\n          children: _jsx(_components.a, {\n            href: \"https://www.baeldung.com/spring-data-save-saveall\",\n            children: \"https://www.baeldung.com/spring-data-save-saveall\"\n          })\n        }), \"\\n\"]\n      })]\n    });\n  }\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"JPA Bulk Insert"},"buildId":"83TotyA5SeDu1ijUHwh-Y","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>